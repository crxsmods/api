<!DOCTYPE html>
<html lang="es" >
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta property="og:image" content="https://github.com/crxsmods.png">
    <title>API | Login</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>
<body>
<!-- partial:index.partial.html -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta property="og:image" content="https://github.com/crxsmods.png">
    <title>API | CrxsMods</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href="https://fonts.googleapis.com/css?family=Raleway|Ubuntu" rel="stylesheet">
    <script>
        if (localStorage.getItem("token")) {
            window.location.href = "/docs";
        }
    </script>
</head>
<body>

   <!-- Formularios -->
    <div class="contenedor-formularios">
        <!-- Links de los formularios -->
        <ul class="contenedor-tabs">
            <li class="tab tab-segunda active"><a href="#iniciar-sesion">Iniciar Sesión</a></li>
            <li class="tab tab-primera"><a href="#registrarse">Registrarse</a></li>
        </ul>

       <!-- Contenido de los Formularios -->
<div class="contenido-tab" style="perspective: 1000px;">
    <!-- Iniciar Sesión -->
    <div id="iniciar-sesion" class="form-box">
        <h1>Iniciar Sesión</h1>
        <form action="#" method="post" id="login-form">
            <!-- Campo para el correo electrónico -->
            <div class="contenedor-input">
                <label for="logmail">Correo <span class="req">*</span></label>
                <input type="email" id="logmail" name="email" required>
            </div>

            <!-- Campo para la contraseña -->
            <div class="contenedor-input">
                <label for="logpass">Contraseña <span class="req">*</span></label>
                <input type="password" id="logpass" name="password" required>
            </div>

            <!-- Enlace para recuperar la contraseña -->
            <p class="forgot">
                <a href="javascript:void(0);" onclick="requestReset()">¿Olvidaste tu contraseña?</a>
            </p>

            <!-- Botón para iniciar sesión -->
            <input type="submit" class="button button-block" value="Iniciar Sesión">
        </form>
    </div>
</div>

<style>
    /* Estilo general del contenedor */
    .contenido-tab {
        max-width: 400px;
        margin: 0 auto;
        padding: 20px;
        background: #f9f9f9;
        border-radius: 10px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        transform-style: preserve-3d;
        transition: transform 0.3s ease;
    }

    .form-box:hover {
        transform: rotateX(5deg) rotateY(-5deg);
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
    }

    /* Estilo de los campos de entrada */
    .contenedor-input {
        margin-bottom: 15px;
        position: relative;
    }

    .contenedor-input label {
        font-weight: bold;
        font-size: 14px;
    }

    .contenedor-input input {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        background: #fff;
        box-shadow: inset 0 1px 5px rgba(0, 0, 0, 0.1);
        transition: box-shadow 0.2s ease, transform 0.2s ease;
    }

    .contenedor-input input:focus {
        box-shadow: 0 0 8px rgba(0, 150, 250, 0.5);
        transform: scale(1.02);
    }

    /* Estilo del botón */
    .button-block {
        width: 100%;
        padding: 12px;
        background: #007bff;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.3s ease, box-shadow 0.3s ease;
        box-shadow: 0 4px 10px rgba(0, 123, 255, 0.3);
    }

    .button-block:hover {
        background: #0056b3;
        box-shadow: 0 6px 15px rgba(0, 123, 255, 0.4);
    }

    /* Estilo del enlace de recuperar contraseña */
    .forgot a {
        color: #007bff;
        text-decoration: none;
        transition: color 0.3s ease;
    }

    .forgot a:hover {
        color: #0056b3;
    }
</style>


          <!-- Registrarse -->
<div id="registrarse" class="form-box">
    <h1>Registrarse</h1>
    <form action="#" method="post" id="register-form">
        <!-- Campo para el correo electrónico -->
        <div class="contenedor-input">
            <label for="regmail">Email <span class="req">*</span></label>
            <input type="email" id="regmail" name="email" required>
        </div>

        <!-- Campo para la contraseña -->
        <div class="contenedor-input">
            <label for="regpass">Contraseña <span class="req">*</span></label>
            <input type="password" id="regpass" name="password" required>
        </div>

        <!-- Campo para repetir la contraseña -->
        <div class="contenedor-input">
            <label for="regpass2">Repetir Contraseña <span class="req">*</span></label>
            <input type="password" id="regpass2" name="confirm-password" required>
        </div>

        <!-- Botón de registro -->
        <input type="submit" class="button button-block" value="Registrarse" id="submitButton">
    </form>
</div>

<style>
    /* Estilo general del formulario */
    .form-box {
        max-width: 400px;
        margin: 0 auto;
        padding: 20px;
        background: #f9f9f9;
        border-radius: 10px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        transform-style: preserve-3d;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    /* Efecto de profundidad en hover */
    .form-box:hover {
        transform: rotateX(3deg) rotateY(-3deg);
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
    }

    /* Estilo de los campos de entrada */
    .contenedor-input {
        margin-bottom: 15px;
    }

    .contenedor-input label {
        font-weight: bold;
        font-size: 14px;
    }

    .contenedor-input input {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        background: #fff;
        box-shadow: inset 0 1px 5px rgba(0, 0, 0, 0.1);
        transition: box-shadow 0.2s ease, transform 0.2s ease;
    }

    .contenedor-input input:focus {
        box-shadow: 0 0 8px rgba(0, 150, 250, 0.5);
        transform: scale(1.02);
    }

    /* Estilo del botón de registro */
    .button-block {
        width: 100%;
        padding: 12px;
        background: #28a745;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.3s ease, box-shadow 0.3s ease;
        box-shadow: 0 4px 10px rgba(40, 167, 69, 0.3);
    }

    .button-block:hover {
        background: #218838;
        box-shadow: 0 6px 15px rgba(40, 167, 69, 0.4);
    }
</style>

   <!-- Contenedor de Contacto -->
<div class="contenedor-contacto">
    <div class="contacto-info">
        <a href="https://wa.me/5217121649714" target="_blank" class="icono">
            <i class="fab fa-whatsapp"></i>
        </a>
        <a href="https://github.com/CrxsMods" target="_blank" class="icono">
            <i class="fab fa-github"></i>
        </a>
        <a href="https://www.paypal.com/paypalme/CrxsMods" target="_blank" class="icono">
            <i class="fab fa-paypal"></i>
        </a>
    </div>
</div>

<style>
    /* Efecto de aparición */
    .contenedor-contacto {
        opacity: 0;
        transform: translateY(20px);
        animation: fadeIn 1s ease-out forwards;
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 20px;
    }

    /* Animación de aparición */
    @keyframes fadeIn {
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Estilos generales para los íconos */
    .icono {
        font-size: 40px;
        color: #000;
        text-decoration: none;
        position: relative;
        transition: transform 0.3s ease, border-color 0.3s ease;
    }

    /* Efecto hover: agrandar ícono y mostrar contorno de color */
    .icono:hover {
        transform: scale(1.2);
        color: #007bff; /* Cambiar el color del ícono al hacer hover */
    }

    /* Efecto de clic: mostrar contorno de color */
    .icono:active {
        border: 2px solid #007bff;
        border-radius: 50%;
        padding: 10px;
        transition: border-color 0.2s ease;
    }

    /* Estilo de los íconos específicos */
    .fa-whatsapp {
        color: #25d366;
    }

    .fa-github {
        color: #333;
    }

    .fa-paypal {
        color: #003087;
    }

    /* Estilo de cambio de color del ícono cuando se pasa el mouse */
    .icono:hover .fa-whatsapp {
        color: #128c7e;
    }

    .icono:hover .fa-github {
        color: #4078c0;
    }

    .icono:hover .fa-paypal {
        color: #009cde;
    }
</style>


    async function requestReset() {
      if (!logmail.value) {
        alert("[❗] Ingrese su correo");
        return;
      }
                
      if (window.recaptchaKey) {
        grecaptcha.ready(function() {
          grecaptcha.execute(window.recaptchaKey, {action: 'submit'}).then(function(token) {
            fetch("/api/manageusers/requestReset", {
              method: "POST",
              headers: {
                "Content-Type": "application/json"
              },
              body: JSON.stringify({
                mail: logmail.value,
                recaptchaVerify: token
              })
            })
              .then(response => response.json())
              .then(data => {
                if (!data.status) {
                  alert(data.message);
                } else {
                  alert(data.message);
                }
              })
              .catch(error => {
                alert("[⚠️] Error en el registro, reporte el error en Github.");
              });
          });
        });
      } else {
        fetch("/api/manageusers/requestReset", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            mail: logmail.value
          })
        })
          .then(response => response.json())
          .then(data => {
            if (!data.status) {
              alert(data.message);
            } else {
              alert(data.message);
            }
          })
          .catch(error => {
            alert("[⚠️] Error en el registro, reporte el error en Github.");
          });
      }
    }

    regg.addEventListener("submit", function(event) {
  event.preventDefault();
  if (reggpass.value !== reggpass2.value) {
    alert("[❗] Las contraseñas no coinciden.");
    return;
  }

  if (reggpass.value.length < 8) {
    alert("[❗] La contraseña debe tener al menos 8 caracteres.");
    return;
  }        
        
  if (window.recaptchaKey) {

  grecaptcha.ready(function() {
          grecaptcha.execute(window.recaptchaKey, {action: 'submit'}).then(function(token) {
              // Add your logic to submit to your backend server here.

  fetch("/api/manageusers/register", {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      mail: regmail.value,
      password: btoa(reggpass.value),
      recaptchaVerify: token
    })
  })
    .then(response => response.json())
    .then(data => {
      if (!data.status) {
        alert(data.message);
      } else if (reggpass.value.length < 8) {
          alert("[❗] La contraseña debe tener al menos 8 caracteres.");
          return;    
      } else {
        alert(data.message);
        window.location.reload()
      }
    })
    .catch(error => {
      alert("[⚠️] Error en el registro, reporte el error en Github.");
    });
});
});

} else {
  fetch("/api/manageusers/register", {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      mail: regmail.value,
      password: btoa(reggpass.value)
    })
  })
    .then(response => response.json())
    .then(data => {
      if (!data.status) {
        alert(data.message);
      } else {
        alert("[❗] Usuario registrado con éxito, revise su bandeja de entrada o de spam en su correo para validarlo.");
        window.location.reload()
      }
    })
    .catch(error => {
      alert("[⚠️] Error en el registro, reporte el error en Github.");
    });
    }

        });
logg.addEventListener("submit", function(event) {
  event.preventDefault();
    
  fetch("/api/manageusers/login", {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      mail: logmail.value,
      password: btoa(logpass.value)
    })
  })
    .then(response => response.json())
    .then(data => {
      if (!data.status) {
        alert(data.message);
      } else {
        localStorage.setItem("token", data.token);
        window.location.href = "/docs";
      }
    })
    .catch(error => {
      alert("[⚠️] Error en el login, reporte el error en Github.");
    });    
});

fetch("/api/manageusers/fetchRecaptcha").then(response => response.json()).then(data => {
  if (!data.status) return;
  window.recaptchaKey = data.sitekey;
  let recap = document.createElement("script")
  recap.src = "https://www.google.com/recaptcha/api.js?render=" + data.sitekey;
  document.head.appendChild(recap);

});
   </script>
   <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
   <script>
    $(document).ready(function(){
        $('.tab a').on('click', function (e) {
            e.preventDefault();

            $(this).parent().addClass('active');
            $(this).parent().siblings().removeClass('active');

            target = $(this).attr('href');

            $('.contenido-tab > div').not(target).hide();

            $(target).fadeIn(600);

        });
})
   </script>
   <script>
    $(document).ready(function(){
        $('.tab a').on('click', function (e) {
            e.preventDefault();

            $(this).parent().addClass('active');
            $(this).parent().siblings().removeClass('active');

            target = $(this).attr('href');

            $('.contenido-tab > div').not(target).hide();

            $(target).fadeIn(600);

        });
})
   </script>

</body>
</html>
<!-- partial -->
  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script><script  src="./script.js"></script>

</body>
</html>
